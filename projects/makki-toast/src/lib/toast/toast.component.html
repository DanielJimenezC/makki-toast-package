<button #buttonRef type="button" data-app-toast
  [attr.data-ready]="ready()" [attr.data-expanded]="open()" 
  [attr.data-exiting]="item.exiting" [attr.data-edge]="expandDir"
  [attr.data-position]="pillAlign" [attr.data-state]="item.state"
  [style.--_h]="open() ? expanded() + 'px' : HEIGHT + 'px'"
  [style.--_pw]="resolvedPillWidth() + 'px'"
  [style.--_px]="pillX() + 'px'"
  [style.--_sy]="open() ? 1 : HEIGHT / pillHeight()"
  [style.--_ph]="pillHeight() + 'px'"
  [style.--_by]="open() ? 1 : 0"
  [style.--_ht]="'translateY(' + (open() ? (expandDir === 'bottom' ? 3 : -3) : 0) + 'px) scale(' + (open() ? 0.9 : 1) + ')'"
  [style.--_co]="open() ? 1 : 0">

  <div data-app-canvas [attr.data-edge]="expandDir">
    <svg data-app-svg [attr.width]="WIDTH" [attr.height]="svgHeight()" [attr.viewBox]="'0 0 ' + WIDTH + ' ' + svgHeight()">
      <defs>
        <filter [attr.id]="filterId()" x="-20%" y="-20%" width="140%" height="140%">
          <feGaussianBlur in="SourceGraphic" [attr.stdDeviation]="blur()" result="blur" />
          <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -10" result="goo" />
          <feComposite in="SourceGraphic" in2="goo" operator="atop" />
        </filter>
      </defs>
      <g [attr.filter]="'url(#' + filterId() + ')'">
        <rect data-app-pill [attr.x]="pillX()" [attr.rx]="resolvedRoundness()" [attr.ry]="resolvedRoundness()" [attr.fill]="item.fill || '#011623'" />
        <rect data-app-body [attr.y]="HEIGHT" [attr.width]="WIDTH" [attr.height]="expandedContent()" [attr.rx]="resolvedRoundness()" [attr.ry]="resolvedRoundness()" [attr.fill]="item.fill || '#011623'" />
      </g>
    </svg>
  </div>

  <div #headerRef data-app-header [attr.data-edge]="expandDir">
    <div data-app-header-stack>
      <div #innerRef data-app-header-inner data-layer="current">
        <div data-app-badge [attr.data-state]="item.state || 'success'">
          @if (hasCustomIcon()) {
            
            @if (isStringIcon()) {
              <span [innerHTML]="iconString() | safeHtml" style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;"></span>
            } @else {
              <ng-container *ngComponentOutlet="iconComponent()"></ng-container>
            }

          } @else {
            <toast-icon [state]="item.state || 'success'"></toast-icon>
          }
        </div>
        <span data-app-title [attr.data-state]="item.state || 'success'">
          {{ item.title || item.state }}
        </span>
      </div>
    </div>
  </div>

  @if (hasDesc()) {
    <div data-app-content [attr.data-edge]="expandDir" [attr.data-visible]="open()">
      <div #contentRef data-app-description style="display: block; overflow: hidden; color: #FFFFFF;">
        @if (item.description) {
          @if (isStringDesc()) {
            <span [innerHTML]="descString() | safeHtml"></span>
          } @else {
            <ng-container *ngComponentOutlet="descComponent(); inputs: descInputs()"></ng-container>
          }
        }

        @if (item.button) {
          <a href="#" data-app-button [attr.data-state]="item.state"
             (click)="handleButtonClick($event)">
            {{ item.button.title }}
          </a>
        }
      </div>
    </div>
  }
</button>